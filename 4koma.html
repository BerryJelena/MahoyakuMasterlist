<!DOCTYPE html>
<html>
<head>
<!-- HTML Meta Tags -->
<title>Event and Event Story Translation Masterlist</title>
<meta name="description" content="A fan-made Mahoyaku masterlist that lists English translations of event and campaigns. ">


<!-- Meta Tags Generated via https://www.opengraph.xyz -->

<link rel="shortcut icon" href="{Favicon}">
<link rel="alternate" type="application/rss+xml" href="{RSS}">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://unpkg.com/phosphor-icons"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js"></script>
<script src="https://static.tumblr.com/p0knose/FpAp5c11c/magnusthemes.combofilters.js"></script>

<script src="/js/hash-lightbox.js"></script>
<link rel="stylesheet" href="css/styling.css">
<link rel="stylesheet" href="css/hash-lightbox.css">

<script>
	    // getting character ids to use chibi heads
    const characterToId = [
        {
            chara: "oz",
            id: 1,
        },
        {
            chara: "arthur",
            id: 2,
        },
        {
            chara: "cain",
            id: 3,
        },
        {
            chara: "riquet",
            id: 4,
        },
        {
            chara: "snow",
            id: 5,
        },
        {
            chara: "white",
            id: 6,
        },
        {
            chara: "mithra",
            id: 7,
        },
        {
            chara: "owen",
            id: 8,
        },
        {
            chara: "bradley",
            id: 9,
        },
        {
            chara: "faust",
            id: 10,
        },
        {
            chara: "shino",
            id: 11,
        },
        {
            chara: "heathcliff",
            id: 12,
        },
        {
            chara: "nero",
            id: 13,
        },
        {
            chara: "shylock",
            id: 14,
        },
        {
            chara: "murr",
            id: 15,
        },
        {
            chara: "chloe",
            id: 16,
        },
        {
            chara: "rustica",
            id: 17,
        },
        {
            chara: "figaro",
            id: 18,
        },
        {
            chara: "rutile",
            id: 19,
        },
        {
            chara: "lennox",
            id: 20,
        },
        {
            chara: "mitile",
            id: 21,
        },
        {
            chara: "akira",
            id: 22,
        },
	{   
            chara: "cockrobin",
            id: 23,
        },
        
    ];
    const yearToId = [
        {
            year: "first",
            id:"1",
        },
        {
            year: "second",
            id:"2",
        },
	    
        {
            year: "third",
            id:"3",
        },
	    
        {
            year: "fourth",
            id:"4",
        },
	    
        {
            year: "fifth",
            id:"5",
        },
	    
        {
            year: "sixth",
            id:"6",
        },
	];
	// sheetID you can find in the URL of your spreadsheet after "spreadsheet/d/"
	const sheetId = "1SHxrt80OQj4RfjnhmkFiGI_pLr03F-f6DUlBoOlsONU";
	// sheetName is the name of the TAB in your spreadsheet
	const sheetName = encodeURIComponent("Output_(4Koma)");
	const sheetURL = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv&sheet=${sheetName}`;
	console.log(sheetURL)
	
	
	
	function csvToObjects(csv) {
	  const csvRows = csv.split("\n");
	  const propertyNames = csvSplit(csvRows[0]);
	  let objects = [];
	  for (let i = 1, max = csvRows.length; i < max; i++) {
	    let thisObject = {};
	    let row = csvSplit(csvRows[i]);
	    for (let j = 0, max = row.length; j < max; j++) {
	      thisObject[propertyNames[j]] = row[j];
	    }
	    objects.push(thisObject);
	  }
	  return objects;
	}
	
	function csvSplit(row) {
	  return row.split(",").map((val) => val.substring(1, val.length - 1));
	}
	
	
    function getComboFilterCustom(filters) {
        var i = 0;
        var comboFilters = [];
        for (var prop in filters) {
            var filterGroup = filters[prop];
            if (!filterGroup.length) {
                continue;
            }
            if (i === 0) {
                comboFilters = filterGroup.slice(0).join().replaceAll(",","");
            } else {
                var filterSelectors = [];
                var groupCombo = Array.isArray(comboFilters) ? comboFilters.slice(0).join().replaceAll(",", "") : comboFilters;
                for (var k = 0, len3 = filterGroup.length; k < len3; k++) {
                        filterSelectors.push(groupCombo + filterGroup[k]);
                }
                comboFilters = filterSelectors;
            }
            i++;
        }
        var comboFilter = Array.isArray(comboFilters) ? comboFilters.join(", ") : comboFilters;
        return comboFilter;
    }
    

    // isotope-combination-filtering
    $(document).ready(function() {

	    fetch(sheetURL)
	  .then((response) => response.text())
	  .then((csvText) => handleResponse(csvText));
	

	function handleResponse(csvText) {
	  let sheetObjects = csvToObjects(csvText);
	  // sheetObjects is now an Array of Objects

	  var arrayLength = sheetObjects.length;
		for (var i = 0; i < arrayLength; i++) {;
			var currObj=sheetObjects[i];
			if (currObj.Event_Name==="") {
			    break;
			  }
			var currName=currObj.Event_Name.replaceAll("$",",")
		//add links if they're there
			var links = currObj.Links.split(" ");
			var linksTxt=``;
			for (var link of links) {
				if (link != "''") {
					var linkN = link.substr(9);
					linkN = linkN.split('/')[0];
					linkN= linkN.split(".", 2).join(" ");
					link=link.replaceAll("$",",");
					
					linksTxt=linksTxt + `<a class="second" href=${link} target="_blank">TL: ${linkN}</a>`;
				}
			}
						       console.log('N');
		//add characters as images
			var characters = currObj.Character.replace(" ","");
			characters= characters.toLowerCase().split("-");
			var chars=``;
			for (const character of characters) {
				let charID = characterToId.find(o => o.chara === character);
				chars=chars+ `<img src="root/assets/aside/tiny_${charID.id}.png" alt=${character} width="10px" height="10px" display=inline-block; />`;
			}

			let yearID = yearToId.find(y => y.id === currObj.Year.toString());      
			
		//get filters
			var flt= currObj.Story.toLowerCase() +' '+ yearID.year +' '+ currObj.Country.toLowerCase() +' '+ characters.join(" ");
			if (currObj.TL==="TRUE"){
				flt=flt+" tl "
			}else {
				flt=flt+" notl "
			}
				
			let eventName = currName.replaceAll("_", " ");
		    // loop on google sheet's event and add an event div for each
			$('#event-grid').append(`<div class="item ${flt}"><div class="box"><img src="root/assets/banner/${currObj.Image}"></div><div class="right"><h2>${eventName}</h2> <i>${currObj.Writer}</i> <table class="masterlist-chapters"> <tr> <td>Chapters</td> <td right>Release</td> </tr> <tr> <td> ${currObj.Chapters} </td> <td right> ${currObj.Release} </td> </tr> </table> <p><b>Characters: </b> ${currObj.Character.replaceAll("-",", ")}</p> <a href="${currObj.Wiki_Link.replaceAll("$",",")}" target="_blank">Wiki</a> ${linksTxt} </div> </div>` );
		}
		    // using javascript to remedy the situation

    // add character names to the div class list
  var $container = $(".grid");
    /*$container.children().each(function() {
        const characters = $(this).children().find("p").text().split(':')[1].replaceAll(" ", "").split(',');
        characters.forEach(character => {
            $(this).addClass(character.toLowerCase());
        });
    });*/
    
    characterToId.forEach(character => {
        $("#character-filter").append(`<li><a href="#" class="filter-icon" data-filter-value="${Array.isArray(character.chara) ? character.chara.map(name => `.${name}`).join().replaceAll(",", "") : `.${character.chara}`}"><img src="root/assets/aside/tiny_${character.id}.png" alt=${Array.isArray(character.chara) ? character.chara.join("/") : character.chara} width="40" height="40" /></a></li>`)
    })
    
     var filters = {};
     var $grid = $container.isotope({
       itemSelector: ".item", 
       percentPosition: true 
     });
	
    
    
    $(".option-set a").live('click', function(e)  {
       var $this = $(this); 
       var filterAttr = "data-filter-value";
       var filterValue = $this.attr(filterAttr);
       var $optionSet = $this.parents(".option-set");
       var group = $optionSet.attr("data-filter-group");
       var filterGroup = filters[group];
       if (!filterGroup) {
         filterGroup = filters[group] = [];
       }
       var $selectAll = $optionSet.find('a['+filterAttr+'=""]');
       var activeClass = "selected",
         exclClass = "exclusive";
     comboFiltering($this,filters,filterAttr,filterValue,$optionSet,group,$selectAll,activeClass,exclClass);
       var comboFilter = getComboFilterCustom(filters);
	   console.log(comboFilter)
       $grid.isotope({
         filter: comboFilter
       });
       $this.toggleClass(activeClass);
       e.preventDefault();
     });
	}
        

    });
    // DARK MODE
    window.addEventListener("DOMContentLoaded", function() {
    const btn = document.querySelector(".lightswitch");
    
    const currentTheme = localStorage.getItem("theme");
    if (currentTheme == "dark") {
    document.body.classList.add("night");
    }
    
    btn.addEventListener("click", function () {
    document.body.classList.toggle("night");
    
    let theme = "light";
    if (document.body.classList.contains("night")) {
    theme = "dark";
    }
    localStorage.setItem("theme", theme);
    });
    });
	

	
    </script>

</head>
<body>
    <!-- The Header -->
    <div class="header">
        <div class="header-left">
            <button class="header-icon-btn">
                <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
            </button>
            <button class="header-icon-btn">
                <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                </svg>
            </button>
            <button class="header-icon-btn">
                <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                </svg>
            </button>
            <button class="header-icon-btn">
                <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
            </button>
            <button class="header-icon-btn">
                <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
                </svg>
            </button>
        </div>
        
        <div class="header-center">
            <button class="header-text-btn active">Portfolio</button>
            <button class="header-text-btn">Services</button>
            <button class="header-text-btn">About</button>
        </div>
        
        <div class="theme-controls">
            <button class="theme-btn active" id="light-theme">
                <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/>
                </svg>
            </button>
            <button class="theme-btn" id="dark-theme">
                <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/>
                </svg>
            </button>
        </div>
    </div>
     <!-- The Sidebar -->
<div class="sidebar">
 
    
    <div class="small-button">
        <table>
            <tr>
                <td> <a href="index"><i class="ph-arrow-u-down-left"></i></a> </td>
                <td> <a href="https://mhykmasterlist.tumblr.com/" target="_blank"><i class="ph-envelope-fill"></i></a></td>
                <td> <a href="https://docs.google.com/spreadsheets/d/1MgcUjuoKyMkxDt715843NLYXpl6N5hbob8kAQ8-y7VY/edit?usp=sharing" target="_blank"><i class="ph-sparkle-fill"></i></a> </td>
                <td> <a href="https://buymeacoffee.com/maripe" target="_blank"><i class="ph ph-coffee"></i></a></td>
		        <td> <a class="lightswitch"><i class="ph-moon-fill"></i></a> </td>
            </tr>
        </table>
    </div>
        
        <div id="filters-container">
        
            <div class="filters">
                <ul class="filter option-set exclusive" data-filter-group="gen">
                <li class="filter option-set exclusive"><a href="#" data-filter-value="" class="reset selected">All</a></li> <!-- IMPROTANT! make sure not to delete! -->
                <li class="filter option-set exclusive"><a href="#" data-filter-value=".tl">TL</a></li>
                <li class="filter option-set exclusive"><a href="#" data-filter-value=".notl">No TL</a></li>
                </ul>
          
                <ul class="filter option-set exclusive" data-filter-group="rarity">
                <li><a href="#" data-filter-value="" class="selected">All</a></li>
                <li><a href="#" data-filter-value=".three">★★★</a></li>
                <li><a href="#" data-filter-value=".four">★★★★</a></li>
                </ul>
        
                <ul class="filter option-set" data-filter-group="unit">
                <h3>COUNTRY</h3>
                <li><a href="#" data-filter-value="" class="selected">All</a></li>
                <li><a href="#" data-filter-value=".central">Central</a></li>
                <li><a href="#" data-filter-value=".north">North</a></li>
                <li><a href="#" data-filter-value=".east">East</a></li>
                <li><a href="#" data-filter-value=".west">West</a></li>
                <li><a href="#" data-filter-value=".south">South</a></li>
                </ul>
        
            </div>
            <div class="charafilters">
                <ul class="charafilter option-set" id="character-filter" data-filter-group="character">
                    <h3>CHARACTER</h3>
                    <li><a href="#" data-filter-value="" class="selected">All</a></li>
                </ul>
            </div>
        </div>
        <!-- HEADER ENDS -->
    </div>

    <div class="content">
      ..
        <!-- GRID STARTS -->
        <section class="grid">
            <div class="item first event west tl">
                <div class="content-card left" data-category="design"> 
                <div class="box"><img src="https://enstarsmasterlist.github.io/main/assets/banner/event_banner_1.png"></div>
                </div>
                <div class="right"><h2>Wounded Wizard</h2>
                <b>4 Koma:</b> <i>N/A</i>
                <p><b>Characters: </b>Oz, Heathcliff, Shino
                </p>
                <a class="second" href="https://mahoyaku.fandom.com/wiki/(Wounded_Wizard)_Oz" target="_blank">Wiki</a></div>
                </div>
            </div> 
        </section>
            <!-- GRID ENDS -->

</div>
</div>
</div>
            </body>
            </html>